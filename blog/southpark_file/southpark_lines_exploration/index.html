<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="description" content="Describe your website">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" href="/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/owl.carousel.css">
<link rel="stylesheet" href="/css/owl.theme.css">


  <link href="/css/style.blue.css" rel="stylesheet" id="theme-stylesheet">


<link href="/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="/img/favicon.png">


</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              
<div id="sidebar" class="col-sb-fixedpos col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
  <div class="sidebar-content">
    <h1 class="sidebar-heading"><a href="/">Yanfei Wu</a></h1>
    <ul class="sidebar-menu">
      
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/blog/">Blogs</a></li>
      

      



 
      

 
      

    </ul>
      <p class="social">
  
  
  
  
  
  <a href="mailto:wuxxx728@umn.edu" data-animate-hover="pulse" class="email">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://www.linkedin.com/in/yanfei-wu-76696383/" data-animate-hover="pulse">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="https://github.com/yanfei-wu" data-animate-hover="pulse">
    <i class="fa fa-github"></i>
  </a>
  
</p>


    <div class="copyright">
      <p class="credit">
        
          &copy;2016 Yanfei Wu
        
        | Template by <a href="https://bootstrapious.com/free-templates" class="external">Bootstrapious.com</a>

&amp; ported to Hugo by <a href="https://github.com/kishaningithub">Kishan B</a>

      </p>
    </div>
  </div>
</div>

<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background col-main-fixedpos">
  <div class="small-navbar visible-xs">
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost pull-left"> <i class="fa fa-align-left"> </i>Menu</button>
  <h1 class="small-navbar-heading"><a href="/">Yanfei Wu</a></h1>
</div>

    <div class="row">
      <div class="col-sm-4">
        <div class="image">
          <img src="/" class="img-responsive" alt="">
        </div>
      </div>

      <div class="col-md-8">
        <h2></h2>
          <p class="author-category">
            
          </p>
          <p class="date-comments">
            <i class="fa fa-calendar"></i> January 1, 0001
          </p>
            
                  
      </div>
    </div>
</br>

    <div class="row">
      <div class="content-column-content">
        <div class="col-lg-10">
          
          

<h2 id="1-set-up">1. Set Up</h2>

<pre><code class="language-python">import pandas as pd
import numpy as np

import matplotlib
import matplotlib.pyplot as plt
import seaborn as sns
%matplotlib inline

from scipy.misc import imread 
import re
from wordcloud import WordCloud, ImageColorGenerator, STOPWORDS
import string

import json
import warnings
warnings.filterwarnings('ignore')
</code></pre>

<pre><code class="language-python">%load_ext version_information
%version_information pandas, numpy, matplotlib, seaborn, scipy, re, wordcloud, json
</code></pre>

<table><tr><th>Software</th><th>Version</th></tr><tr><td>Python</td><td>3.5.2 64bit [GCC 4.2.1 Compatible Apple LLVM 4.2 (clang-425.0.28)]</td></tr><tr><td>IPython</td><td>5.1.0</td></tr><tr><td>OS</td><td>Darwin 16.1.0 x86_64 i386 64bit</td></tr><tr><td>pandas</td><td>0.18.1</td></tr><tr><td>numpy</td><td>1.11.1</td></tr><tr><td>matplotlib</td><td>1.5.3</td></tr><tr><td>seaborn</td><td>0.7.1</td></tr><tr><td>scipy</td><td>0.18.1</td></tr><tr><td>re</td><td>2.2.1</td></tr><tr><td>wordcloud</td><td>1.2.1</td></tr><tr><td>json</td><td>2.0.9</td></tr><tr><td colspan='2'>Fri Mar 24 12:51:26 2017 PDT</td></tr></table>

<pre><code class="language-python"># customized plot style
s = json.load( open(&quot;plot_style.json&quot;) )
matplotlib.rcParams.update(s)
</code></pre>

<h2 id="2-read-and-clean-data">2. Read and Clean Data</h2>

<p><em>Dataset was downloaded from <a href="https://www.kaggle.com/tovarischsukhov/southparklines">Kaggle</a></em></p>

<pre><code class="language-python">lines = pd.read_csv('All-seasons.csv')
print(lines.shape)
lines.head()
</code></pre>

<pre><code>(70896, 4)
</code></pre>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Season</th>
      <th>Episode</th>
      <th>Character</th>
      <th>Line</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>1</td>
      <td>Stan</td>
      <td>You guys, you guys! Chef is going away. \n</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>1</td>
      <td>Kyle</td>
      <td>Going away? For how long?\n</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>1</td>
      <td>Stan</td>
      <td>Forever.\n</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>1</td>
      <td>Chef</td>
      <td>I'm sorry boys.\n</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>1</td>
      <td>Stan</td>
      <td>Chef said he's been bored, so he joining a gro...</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># check na
pd.isnull(lines).sum()
</code></pre>

<pre><code>Season       0
Episode      0
Character    0
Line         0
dtype: int64
</code></pre>

<pre><code class="language-python"># unique seasons
lines.Season.unique()
</code></pre>

<pre><code>array(['10', 'Season', '11', '12', '13', '14', '15', '16', '17', '18', '1',
       '2', '3', '4', '5', '6', '7', '8', '9'], dtype=object)
</code></pre>

<pre><code class="language-python"># 'Season' as one of the unique seasons. something is wrong
lines[lines['Season'] == 'Season'].head()
</code></pre>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Season</th>
      <th>Episode</th>
      <th>Character</th>
      <th>Line</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3471</th>
      <td>Season</td>
      <td>Episode</td>
      <td>Character</td>
      <td>Line</td>
    </tr>
    <tr>
      <th>6950</th>
      <td>Season</td>
      <td>Episode</td>
      <td>Character</td>
      <td>Line</td>
    </tr>
    <tr>
      <th>10258</th>
      <td>Season</td>
      <td>Episode</td>
      <td>Character</td>
      <td>Line</td>
    </tr>
    <tr>
      <th>13516</th>
      <td>Season</td>
      <td>Episode</td>
      <td>Character</td>
      <td>Line</td>
    </tr>
    <tr>
      <th>16863</th>
      <td>Season</td>
      <td>Episode</td>
      <td>Character</td>
      <td>Line</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># remove rows not filled with correct information
lines = lines[(lines['Season'] != 'Season') | (lines['Episode'] != 'Episode') | (lines['Character'] != 'Character') | (lines['Line'] != 'Line')]
</code></pre>

<pre><code class="language-python"># convert 'Season', 'Episode' to integer
lines['Season'] = lines['Season'].astype(int)
lines['Episode'] = lines['Episode'].astype(int)
</code></pre>

<pre><code class="language-python"># clean the lines
# remove newline
lines['Line'] = lines['Line'].apply(lambda x: re.sub('\n', '', x))

# remove punctuations in the lines and convert to lower case -&gt; as a new variable
exclude = list(string.punctuation)
exclude.remove(&quot;'&quot;) # not to mess up with words like I'm, He'll
lines['Line_nopunc'] = lines['Line'].apply(lambda x: ''.join([s.lower() for s in x if s not in exclude]))
</code></pre>

<pre><code class="language-python">lines.head()
</code></pre>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Season</th>
      <th>Episode</th>
      <th>Character</th>
      <th>Line</th>
      <th>Line_nopunc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>1</td>
      <td>Stan</td>
      <td>You guys, you guys! Chef is going away.</td>
      <td>you guys you guys chef is going away</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>1</td>
      <td>Kyle</td>
      <td>Going away? For how long?</td>
      <td>going away for how long</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10</td>
      <td>1</td>
      <td>Stan</td>
      <td>Forever.</td>
      <td>forever</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>1</td>
      <td>Chef</td>
      <td>I'm sorry boys.</td>
      <td>i'm sorry boys</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>1</td>
      <td>Stan</td>
      <td>Chef said he's been bored, so he joining a gro...</td>
      <td>chef said he's been bored so he joining a grou...</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">print(&quot;Total number of lines: {}&quot;.format(lines.shape[0]))
</code></pre>

<pre><code>Total number of lines: 70879
</code></pre>

<h2 id="3-data-visualization">3. Data Visualization</h2>

<h3 id="3-1-line-length-number-of-words">3-1. Line Length (Number of Words)</h3>

<pre><code class="language-python"># add a new variable 'Word' representing number of words for each line
lines['Word'] = lines['Line_nopunc'].apply(lambda x: len(x.split()))
</code></pre>

<pre><code class="language-python"># some statistics
lines.Word.describe()
</code></pre>

<pre><code>count    70879.000000
mean        11.446211
std         13.318312
min          0.000000
25%          4.000000
50%          8.000000
75%         14.000000
max        312.000000
Name: Word, dtype: float64
</code></pre>

<pre><code class="language-python"># plot the distribution
p = sns.distplot(lines.Word, bins = 50, color = 'blue')
p.set(xlabel = 'Number of Words per Line', ylabel = 'Frequency')
p.set_title('Distribution of Line Length', fontweight = 'bold')
</code></pre>

<pre><code>&lt;matplotlib.text.Text at 0x11c0067f0&gt;
</code></pre>

<p><img src="output_19_1.png" alt="png" /></p>

<p>Over 75% of the lines are short with less than 15 words.</p>

<pre><code class="language-python">print(&quot;Total number of words: {}&quot;.format(lines.Word.sum()))
</code></pre>

<pre><code>Total number of words: 811296
</code></pre>

<h3 id="3-2-basic-information-over-seasons">3-2. Basic Information over Seasons</h3>

<pre><code class="language-python"># group by season
byseason = lines.groupby('Season').agg({'Episode': lambda x: x.nunique(), \
                                        'Character': lambda x: x.nunique(), \
                                        'Line': 'count', 'Word': 'sum'}).reset_index()
</code></pre>

<pre><code class="language-python">byseason['Line_per_Episode'] = byseason['Line']/byseason['Episode']
byseason['Word_per_Episode'] = byseason['Word']/byseason['Episode']
</code></pre>

<pre><code class="language-python">byseason.head()
</code></pre>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Season</th>
      <th>Episode</th>
      <th>Word</th>
      <th>Character</th>
      <th>Line</th>
      <th>Line_per_Episode</th>
      <th>Word_per_Episode</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>13</td>
      <td>40025</td>
      <td>247</td>
      <td>4170</td>
      <td>320.769231</td>
      <td>3078.846154</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>18</td>
      <td>63352</td>
      <td>442</td>
      <td>6416</td>
      <td>356.444444</td>
      <td>3519.555556</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>17</td>
      <td>58023</td>
      <td>447</td>
      <td>5798</td>
      <td>341.058824</td>
      <td>3413.117647</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>17</td>
      <td>60250</td>
      <td>478</td>
      <td>5680</td>
      <td>334.117647</td>
      <td>3544.117647</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>14</td>
      <td>48783</td>
      <td>379</td>
      <td>4414</td>
      <td>315.285714</td>
      <td>3484.500000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">byseason.describe()
</code></pre>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Season</th>
      <th>Episode</th>
      <th>Word</th>
      <th>Character</th>
      <th>Line</th>
      <th>Line_per_Episode</th>
      <th>Word_per_Episode</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>18.000000</td>
      <td>18.000000</td>
      <td>18.000000</td>
      <td>18.000000</td>
      <td>18.000000</td>
      <td>18.000000</td>
      <td>18.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>9.500000</td>
      <td>14.277778</td>
      <td>45072.000000</td>
      <td>362.333333</td>
      <td>3937.722222</td>
      <td>271.791236</td>
      <td>3141.538844</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.338539</td>
      <td>2.108960</td>
      <td>9236.274873</td>
      <td>69.473651</td>
      <td>1147.732435</td>
      <td>44.566578</td>
      <td>253.328793</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>10.000000</td>
      <td>32073.000000</td>
      <td>238.000000</td>
      <td>2305.000000</td>
      <td>221.500000</td>
      <td>2710.357143</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.250000</td>
      <td>14.000000</td>
      <td>39953.000000</td>
      <td>330.000000</td>
      <td>3269.500000</td>
      <td>236.910714</td>
      <td>2984.535714</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>9.500000</td>
      <td>14.000000</td>
      <td>42142.500000</td>
      <td>372.500000</td>
      <td>3502.000000</td>
      <td>252.028571</td>
      <td>3070.565934</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>13.750000</td>
      <td>14.750000</td>
      <td>48750.000000</td>
      <td>399.250000</td>
      <td>4369.500000</td>
      <td>311.920168</td>
      <td>3370.688235</td>
    </tr>
    <tr>
      <th>max</th>
      <td>18.000000</td>
      <td>18.000000</td>
      <td>63352.000000</td>
      <td>478.000000</td>
      <td>6416.000000</td>
      <td>356.444444</td>
      <td>3544.117647</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">fig, ax = plt.subplots(nrows=4, ncols=1, sharex=True, sharey=False, figsize=(7, 6))

ax[0].plot(byseason.Season, byseason.Episode, marker = 'o', color = 'orange', linestyle=':', \
           linewidth = 0.5, label = 'Episodes')
ax[0].axhline(y=byseason.Episode.mean(), c=&quot;black&quot;,linewidth=2, linestyle=':', label = 'Mean')
ax[0].set_xlim([0, 20])
ax[0].set_ylim([9, 19])
ax[0].grid(False)
ax[0].legend()

ax[1].plot(byseason.Season, byseason.Character, marker = 'o', color = 'green', linestyle=':', \
        linewidth = 0.5, label = 'Characters')
ax[1].axhline(y=byseason.Character.mean(), c=&quot;black&quot;,linewidth=2, linestyle=':', label = 'Mean')
ax[1].set_xlim([0, 20])
ax[1].grid(False)
ax[1].legend()

ax[2].plot(byseason.Season, byseason.Line_per_Episode, marker = 'o', color = 'r', linestyle=':', \
        linewidth = 0.5, label = 'Lines (per Episode Average)')
ax[2].axhline(y=byseason.Line_per_Episode.mean(), c=&quot;black&quot;,linewidth=2, linestyle=':', label = 'Mean')
ax[2].set_xlim([0, 20])
ax[2].set_ylim([210, 370])
ax[2].grid(False)
ax[2].legend()

ax[3].plot(byseason.Season, byseason.Word_per_Episode, marker = 'o', color = 'b', linestyle=':', \
       linewidth = 0.5, label = 'Words (per Episode Average)')
ax[3].axhline(y=byseason.Word_per_Episode.mean(), c='black', linewidth=2, linestyle=':', label='Mean')
ax[3].set_xlim([0, 20])
ax[3].set_ylim([2600, 3700])
ax[3].grid(False)
ax[3].legend()
           
fig.text(0.5, 0, 'Season', ha='center')
fig.text(0, 0.5, 'Count', va='center', rotation='vertical')
fig.suptitle('', fontsize = 14, y = 1.02)
fig.tight_layout()
</code></pre>

<p><img src="output_27_0.png" alt="png" /></p>

<pre><code class="language-python">print(&quot;Total episodes in the 18 seasons: {}&quot;.format(byseason.Episode.sum()))
</code></pre>

<pre><code>Total episodes in the 18 seasons: 257
</code></pre>

<h3 id="3-3-characters-who-appreared-in-all-the-seasons">3-3. Characters Who Appreared in All the Seasons</h3>

<pre><code class="language-python"># recuring characters
seasons = lines.Season.unique()
characters = lines.Character.unique()
print(&quot;Total number of unique characters: {}&quot;.format(len(characters)))
for season in seasons:
    character = lines[lines['Season'] == season].Character.unique()
    characters = [item for item in characters if item in character]
</code></pre>

<pre><code>Total number of unique characters: 3949
</code></pre>

<pre><code class="language-python">print(&quot;Number of characters who appear in all 18 seasons: {}&quot;.format(len(characters)))
print(characters)
</code></pre>

<pre><code>Number of characters who appear in all 18 seasons: 16
['Stan', 'Kyle', 'Cartman', 'Gerald', 'Mr. Mackey', 'Randy', 'Kenny', 'Clyde', 'Woman', 'Sheila', 'Man', 'Announcer', 'Sharon', 'Wendy', 'Principal Victoria', 'Liane']
</code></pre>

<h3 id="3-4-characters-who-spoke-most">3-4. Characters Who Spoke Most</h3>

<pre><code class="language-python"># group by character
bycharacter = lines.groupby('Character').agg({'Line': 'count', 'Word': 'sum'}).reset_index()
bycharacter = bycharacter.sort_values(['Line', 'Word'], ascending = False)
bycharacter.head(10)
</code></pre>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Character</th>
      <th>Word</th>
      <th>Line</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>621</th>
      <td>Cartman</td>
      <td>129680</td>
      <td>9774</td>
    </tr>
    <tr>
      <th>3384</th>
      <td>Stan</td>
      <td>68901</td>
      <td>7680</td>
    </tr>
    <tr>
      <th>1832</th>
      <td>Kyle</td>
      <td>63642</td>
      <td>7099</td>
    </tr>
    <tr>
      <th>567</th>
      <td>Butters</td>
      <td>29322</td>
      <td>2602</td>
    </tr>
    <tr>
      <th>2942</th>
      <td>Randy</td>
      <td>31087</td>
      <td>2467</td>
    </tr>
    <tr>
      <th>2314</th>
      <td>Mr. Garrison</td>
      <td>15038</td>
      <td>1002</td>
    </tr>
    <tr>
      <th>681</th>
      <td>Chef</td>
      <td>11082</td>
      <td>917</td>
    </tr>
    <tr>
      <th>1785</th>
      <td>Kenny</td>
      <td>4159</td>
      <td>881</td>
    </tr>
    <tr>
      <th>3228</th>
      <td>Sharon</td>
      <td>8600</td>
      <td>862</td>
    </tr>
    <tr>
      <th>2341</th>
      <td>Mr. Mackey</td>
      <td>10680</td>
      <td>633</td>
    </tr>
  </tbody>
</table>
</div>

<p>Some of the top characters actually did not appear in all the seasons, such as Butters (who entered the show in Season 2) and Mr. Garrison.</p>

<pre><code class="language-python">fig, ax = plt.subplots(nrows=1, ncols=2, figsize=(11, 4))
sns.barplot(x = 'Line', y='Character', data=bycharacter.head(10), palette = 'coolwarm_r', ax=ax[0])
ax[0].set(xlabel='Number of Lines', ylabel='')

sns.barplot(x = 'Word', y='Character', data=bycharacter.sort_values(['Word', 'Line'], ascending = False).head(10), \
            palette = 'coolwarm_r', ax=ax[1])
ax[1].set(xlabel='Number of Words', ylabel='')

fig.suptitle('Top Speakers')
</code></pre>

<pre><code>&lt;matplotlib.text.Text at 0x11f23d6d8&gt;
</code></pre>

<p><img src="output_35_1.png" alt="png" /></p>

<pre><code class="language-python"># add new variable 'Length': average length of the lines
bycharacter['Length'] = bycharacter['Word']/bycharacter['Line']
bycharacter.head(10)
</code></pre>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Character</th>
      <th>Word</th>
      <th>Line</th>
      <th>Length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>621</th>
      <td>Cartman</td>
      <td>129680</td>
      <td>9774</td>
      <td>13.267853</td>
    </tr>
    <tr>
      <th>3384</th>
      <td>Stan</td>
      <td>68901</td>
      <td>7680</td>
      <td>8.971484</td>
    </tr>
    <tr>
      <th>1832</th>
      <td>Kyle</td>
      <td>63642</td>
      <td>7099</td>
      <td>8.964925</td>
    </tr>
    <tr>
      <th>567</th>
      <td>Butters</td>
      <td>29322</td>
      <td>2602</td>
      <td>11.269024</td>
    </tr>
    <tr>
      <th>2942</th>
      <td>Randy</td>
      <td>31087</td>
      <td>2467</td>
      <td>12.601135</td>
    </tr>
    <tr>
      <th>2314</th>
      <td>Mr. Garrison</td>
      <td>15038</td>
      <td>1002</td>
      <td>15.007984</td>
    </tr>
    <tr>
      <th>681</th>
      <td>Chef</td>
      <td>11082</td>
      <td>917</td>
      <td>12.085060</td>
    </tr>
    <tr>
      <th>1785</th>
      <td>Kenny</td>
      <td>4159</td>
      <td>881</td>
      <td>4.720772</td>
    </tr>
    <tr>
      <th>3228</th>
      <td>Sharon</td>
      <td>8600</td>
      <td>862</td>
      <td>9.976798</td>
    </tr>
    <tr>
      <th>2341</th>
      <td>Mr. Mackey</td>
      <td>10680</td>
      <td>633</td>
      <td>16.872038</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># statistics
bycharacter.describe()
</code></pre>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Word</th>
      <th>Line</th>
      <th>Length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3949.000000</td>
      <td>3949.000000</td>
      <td>3949.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>205.443403</td>
      <td>17.948595</td>
      <td>10.864565</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2688.393553</td>
      <td>238.722578</td>
      <td>11.164474</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>6.000000</td>
      <td>1.000000</td>
      <td>4.166667</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>21.000000</td>
      <td>2.000000</td>
      <td>8.391304</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>72.000000</td>
      <td>6.000000</td>
      <td>13.658537</td>
    </tr>
    <tr>
      <th>max</th>
      <td>129680.000000</td>
      <td>9774.000000</td>
      <td>163.000000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># distribution of average line length by character
p = sns.distplot(bycharacter.Length, bins = 50, color = 'blue')
p.set(xlabel = 'Average Line Length (by Character)', ylabel = 'Frequency')
p.set_title('Distribution of Average Line Length', fontweight = 'bold')
</code></pre>

<pre><code>&lt;matplotlib.text.Text at 0x11f6824e0&gt;
</code></pre>

<p><img src="output_38_1.png" alt="png" /></p>

<pre><code class="language-python"># plot the number of lines and the average line length for the top 5 speakers
N = 5
ind = np.arange(N) 
width = 0.35

fig, ax1 = plt.subplots()
ax1.bar(ind, bycharacter.Line[:5], width, color='r')
ax1.grid(False)
ax1.set_ylabel('Number of Lines', color='r', alpha = 0.7)
ax1.tick_params('y', colors='r')

ax2 = ax1.twinx()
ax2.bar(ind + width, bycharacter.Length[:5], width, color='b', alpha = 0.7)
ax2.grid(False)
ax2.set_ylabel('Average Line Length', color='b')
ax2.tick_params('y', colors='b')
ax2.set_xlim([-width, N])
ax2.set_xticks(ind + width)
ax2.set_xticklabels(('Cartman', 'Stan', 'Kyle', 'Butters', 'Randy'))

fig.suptitle('Top Speakers', fontsize = 14)
</code></pre>

<pre><code>&lt;matplotlib.text.Text at 0x11f8cb9e8&gt;
</code></pre>

<p><img src="output_39_1.png" alt="png" /></p>

<ul>
<li>Cartman, as the No.1 speaker, spoke the most lines and his lines are relatively long sentences (average line length around the 75 pencentile)</li>
<li>Butters and Randy have significantly less line shares compared with Stan and Kyle, but their lines are a little longer</li>
</ul>

<h3 id="3-5-all-lines">3-5. All Lines</h3>

<pre><code class="language-python"># all lines
text = ' '.join(lines.Line_nopunc)

# all words in these lines (no stopwords)
word_nostopword = [word for word in text.split() if word not in STOPWORDS]

# unique words in all lines 
print(&quot;Total number of unique words (including stopwords): {}&quot;.format(len(set(text.split()))))
print(&quot;Total number of unique words (excluding stopwords): {}&quot;.format(len(set(word_nostopword))))
</code></pre>

<pre><code>Total number of unique words (including stopwords): 30347
Total number of unique words (excluding stopwords): 30168
</code></pre>

<pre><code class="language-python"># wordcloud visualization
mask = imread('cartman.jpg') # mask
image_colors = ImageColorGenerator(mask) # custom color using mask image

wc = WordCloud(background_color = 'white', mask = mask, max_words = 3000, \
               stopwords = STOPWORDS, color_func = image_colors, scale = 1.0, random_state= 12)
wc.generate(text)
wc.to_file('cartman_wordcloud2.png')

plt.figure(figsize = (6, 6), facecolor = 'white')
plt.imshow(wc)
plt.axis('off')
</code></pre>

<pre><code>(-0.5, 1702.5, 1574.5, -0.5)
</code></pre>

<p><img src="output_43_1.png" alt="png" /></p>

<h3 id="3-6-lines-of-top-speakers">3-6. Lines of top speakers</h3>

<pre><code class="language-python"># top_speakers = ['Cartman', 'Stan', 'Kyle', 'Butters', 'Randy']
cartman = lines[lines['Character'] == 'Cartman']
cartman_byseason = cartman.groupby('Season').agg({'Line': 'count', 'Word': 'sum'}).reset_index()

stan = lines[lines['Character'] == 'Stan']
stan_byseason = stan.groupby('Season').agg({'Line': 'count', 'Word': 'sum'}).reset_index()

kyle = lines[lines['Character'] == 'Kyle']
kyle_byseason = kyle.groupby('Season').agg({'Line': 'count', 'Word': 'sum'}).reset_index()

butters = lines[lines['Character'] == 'Butters']
butters_byseason = butters.groupby('Season').agg({'Line': 'count', 'Word': 'sum'}).reset_index()

randy = lines[lines['Character'] == 'Randy']
randy_byseason = randy.groupby('Season').agg({'Line': 'count', 'Word': 'sum'}).reset_index()
</code></pre>

<pre><code class="language-python"># butters did not appear in season 1
butters_byseason.loc[-1] = [1, 0, 0]
butters_byseason.index = butters_byseason.index + 1  # shifting index
butters_byseason = butters_byseason.sort()  # sorting by index
</code></pre>

<pre><code class="language-python"># plot percent of words spoken by top characters in each season
plt.plot(cartman_byseason.Season, cartman_byseason.Word/byseason.Word, marker = 'o', color = 'c', linestyle=':', \
        linewidth = 0.5, markersize = 5, label = 'Cartman')
plt.plot(stan_byseason.Season, stan_byseason.Word/byseason.Word, marker = 'o', color = 'purple', linestyle=':', \
        linewidth = 0.5, markersize = 5, label = 'Stan')
plt.plot(kyle_byseason.Season, kyle_byseason.Word/byseason.Word, marker = 'o', color = 'green', linestyle=':', \
        linewidth = 0.5, markersize = 5, label = 'Kyle')
plt.plot(butters_byseason.Season, butters_byseason.Word/byseason.Word, marker = 'o', color = 'orange', linestyle=':', \
        linewidth = 0.5, markersize = 5, label = 'Butters')
plt.plot(randy_byseason.Season, randy_byseason.Word/byseason.Word, marker = 'o', color = 'black', linestyle=':', \
        linewidth = 0.5, markersize = 5, label = 'Randy')

plt.xlim([0, 20])
plt.ylim([-0.02, 0.22])
plt.xlabel('Season')
plt.ylabel('Word Share')
plt.title('Word Shares of Top Speakers by Season', fontweight = 'bold')
plt.legend(bbox_to_anchor=(1, 0.75), loc='upper left', ncol=1)
</code></pre>

<pre><code>&lt;matplotlib.legend.Legend at 0x1204b0fd0&gt;
</code></pre>

<p><img src="output_47_1.png" alt="png" /></p>

<pre><code class="language-python"># plot line length of top characters in each season
plt.plot(cartman_byseason.Season, cartman_byseason.Word/cartman_byseason.Line, marker = 'o', color = 'c', linestyle=':', \
        linewidth = 0.5, markersize = 5, label = 'Cartman')
plt.plot(stan_byseason.Season, stan_byseason.Word/stan_byseason.Line, marker = 'o', color = 'purple', linestyle=':', \
        linewidth = 0.5, markersize = 5, label = 'Stan')
plt.plot(kyle_byseason.Season, kyle_byseason.Word/kyle_byseason.Line, marker = 'o', color = 'green', linestyle=':', \
        linewidth = 0.5, markersize = 5, label = 'Kyle')
plt.plot(butters_byseason.Season, butters_byseason.Word/(butters_byseason.Line + 1), marker = 'o', color = 'orange', linestyle=':', \
        linewidth = 0.5, markersize = 5, label = 'Butters')
plt.plot(randy_byseason.Season, randy_byseason.Word/randy_byseason.Line, marker = 'o', color = 'black', linestyle=':', \
        linewidth = 0.5, markersize = 5, label = 'Randy')

plt.xlim([0, 20])
plt.ylim([-0.5, 20.5])
plt.xlabel('Season')
plt.ylabel('Average Line Length')
plt.title('Line Length of Top Speakers by Season', fontweight = 'bold')
plt.legend(bbox_to_anchor=(1, 0.75), loc='upper left', ncol=1)
</code></pre>

<pre><code>&lt;matplotlib.legend.Legend at 0x1206811d0&gt;
</code></pre>

<p><img src="output_48_1.png" alt="png" /></p>

<p>Cartman remained to be No. 1 speaker throughout the seasons. Stan and Kyle started off similarly like Cartman but decreases later. Butters and Randy did not speak much in the first 4 seasons but they rise to be top speakers and have similar word shares as Stan and Kyle.</p>

<pre><code class="language-python"># What did butters say in season 2?
butters[butters['Season'] == 2]['Line']
</code></pre>

<pre><code>35651         Me, too!
35964    Pass this up.
Name: Line, dtype: object
</code></pre>

<pre><code class="language-python"># who else are top speakers when the show started (season 1)?
bycharacter_s1 = lines[lines['Season'] == 1].groupby('Character').agg({'Line': 'count', 'Word': 'sum'}).reset_index()
bycharacter_s1 = bycharacter_s1.sort_values(['Line', 'Word'], ascending = False)
bycharacter_s1.head()
</code></pre>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Character</th>
      <th>Word</th>
      <th>Line</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>209</th>
      <td>Stan</td>
      <td>4934</td>
      <td>651</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Cartman</td>
      <td>6238</td>
      <td>624</td>
    </tr>
    <tr>
      <th>111</th>
      <td>Kyle</td>
      <td>4296</td>
      <td>555</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Chef</td>
      <td>3057</td>
      <td>251</td>
    </tr>
    <tr>
      <th>142</th>
      <td>Mr. Garrison</td>
      <td>2898</td>
      <td>212</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="3-7-words-by-characters">3-7. Words by Characters</h3>

<h4 id="word-frequency">Word frequency</h4>

<pre><code class="language-python"># combine lines by character
character_lines = lines.groupby('Character')['Line_nopunc'].apply(list).reset_index()
character_lines['Line_nopunc'] = character_lines['Line_nopunc'].apply(lambda x: ' '.join(x))
</code></pre>

<pre><code class="language-python"># put lines together into a text file for each top speaker
cartman_text = ''.join(character_lines[character_lines['Character'] == 'Cartman']['Line_nopunc'])
stan_text = ''.join(character_lines[character_lines['Character'] == 'Stan']['Line_nopunc'])
kyle_text = ''.join(character_lines[character_lines['Character'] == 'Kyle']['Line_nopunc'])
butters_text = ''.join(character_lines[character_lines['Character'] == 'Butters']['Line_nopunc'])
randy_text = ''.join(character_lines[character_lines['Character'] == 'Randy']['Line_nopunc'])
</code></pre>

<pre><code class="language-python">from collections import Counter

# mostly spoken words for the top speakers (exclude stopwords)
# cartman 
cartman_word = [w for w in cartman_text.split()]
cartman_nostopword = [w for w in cartman_word if w not in list(STOPWORDS)]
cartman_mostfreq = Counter(cartman_nostopword).most_common(20)
cartman_df = pd.DataFrame(cartman_mostfreq, columns = ['Word', 'Count'])

# stan
stan_word = [w for w in stan_text.split()]
stan_nostopword = [w for w in stan_word if w not in list(STOPWORDS)]
stan_mostfreq = Counter(stan_nostopword).most_common(20)
stan_df = pd.DataFrame(stan_mostfreq, columns = ['Word', 'Count'])

# kyle
kyle_word = [w for w in kyle_text.split()]
kyle_nostopword = [w for w in kyle_word if w not in list(STOPWORDS)]
kyle_mostfreq = Counter(kyle_nostopword).most_common(20)
kyle_df = pd.DataFrame(kyle_mostfreq, columns = ['Word', 'Count'])

# butters
butters_word = [w for w in butters_text.split()]
butters_nostopword = [w for w in butters_word if w not in list(STOPWORDS)]
butters_mostfreq = Counter(butters_nostopword).most_common(20)
butters_df = pd.DataFrame(butters_mostfreq, columns = ['Word', 'Count'])

# randy
randy_word = [w for w in randy_text.split()]
randy_nostopword = [w for w in randy_word if w not in list(STOPWORDS)]
randy_mostfreq = Counter(randy_nostopword).most_common(20)
randy_df = pd.DataFrame(randy_mostfreq, columns = ['Word', 'Count'])
</code></pre>

<pre><code class="language-python">fig = plt.figure(figsize=(6, 5.7), facecolor = 'white')
ax = fig.add_subplot(111)

ax.text(0.075, 0, '\n'.join(cartman_df.Word), bbox={'facecolor': 'red', 'edgecolor': 'black', 'alpha': 0.3, 'pad':5})
ax.text(0.075, 0.95, 'Cartman', fontweight='bold')
ax.text(0.275, 0, '\n'.join(stan_df.Word), bbox={'facecolor': 'red', 'edgecolor': 'black', 'alpha': 0.3, 'pad':5})
ax.text(0.275, 0.95, 'Stan', fontweight='bold')
ax.text(0.475, 0, '\n'.join(kyle_df.Word), bbox={'facecolor': 'red', 'edgecolor': 'black', 'alpha': 0.3, 'pad':5})
ax.text(0.475, 0.95, 'Kyle', fontweight='bold')
ax.text(0.675, 0, '\n'.join(butters_df.Word), bbox={'facecolor': 'red', 'edgecolor': 'black', 'alpha': 0.3, 'pad':5})
ax.text(0.675, 0.95, 'Butters', fontweight='bold')
ax.text(0.875, 0, '\n'.join(randy_df.Word), bbox={'facecolor': 'red', 'edgecolor': 'black', 'alpha': 0.3, 'pad':5})
ax.text(0.875, 0.95, 'Randy', fontweight='bold')

fig.suptitle('Top 20 Most Frequent Words', fontweight='bold')
plt.axis('off')
</code></pre>

<pre><code>(0.0, 1.0, 0.0, 1.0)
</code></pre>

<p><img src="output_57_1.png" alt="png" /></p>

<h4 id="tf-idf">TF IDF</h4>

<pre><code class="language-python">def top_tfidf_feats(row, features, top_n=20):
    ''' Get top n tfidf values in row and return them with their corresponding feature names.'''
    topn_ids = np.argsort(row)[::-1][:top_n]
    top_feats = [(features[i], row[i]) for i in topn_ids]
    df = pd.DataFrame(top_feats)
    df.columns = ['feature', 'tfidf']
    return df

def top_feats_in_doc(vec, features, row_id, top_n=20):
    ''' Top tfidf features in specific document (matrix row) '''
    row = np.squeeze(vec[row_id].toarray())
    return top_tfidf_feats(row, features, top_n)
</code></pre>

<pre><code class="language-python">from sklearn.feature_extraction.text import TfidfVectorizer
vec_1g = TfidfVectorizer(ngram_range=(1, 1), stop_words=STOPWORDS)
vec_2g = TfidfVectorizer(ngram_range=(2, 3), stop_words=STOPWORDS)

doc = character_lines.Line_nopunc

vec_1g.fit(doc)
features_1g = vec_1g.get_feature_names()
vec1 = vec_1g.transform([' '.join(cartman_nostopword)] + [' '.join(stan_nostopword)] + \
                        [' '.join(kyle_nostopword)] + [' '.join(butters_nostopword)] + \
                        [' '.join(randy_nostopword)])

vec_2g.fit(doc)
features_2g = vec_2g.get_feature_names()
vec2 = vec_2g.transform([' '.join(cartman_nostopword)] + [' '.join(stan_nostopword)] + \
                        [' '.join(kyle_nostopword)] + [' '.join(butters_nostopword)] + \
                        [' '.join(randy_nostopword)])
</code></pre>

<pre><code class="language-python"># find out words with the highest tfidf
cartman_top1g = top_feats_in_doc(vec1, features_1g, row_id=0, top_n=20)
stan_top1g = top_feats_in_doc(vec1, features_1g, row_id=1, top_n=20)
kyle_top1g = top_feats_in_doc(vec1, features_1g, row_id=2, top_n=20)
butters_top1g = top_feats_in_doc(vec1, features_1g, row_id=3, top_n=20)
randy_top1g = top_feats_in_doc(vec1, features_1g, row_id=4, top_n=20)

cartman_top2g = top_feats_in_doc(vec2, features_2g, row_id=0, top_n=20)
stan_top2g = top_feats_in_doc(vec2, features_2g, row_id=1, top_n=20)
kyle_top2g = top_feats_in_doc(vec2, features_2g, row_id=2, top_n=20)
butters_top2g = top_feats_in_doc(vec2, features_2g, row_id=3, top_n=20)
randy_top2g = top_feats_in_doc(vec2, features_2g, row_id=4, top_n=20)
</code></pre>

<pre><code class="language-python">fig = plt.figure(figsize=(6, 5.7), facecolor = 'white')
ax = fig.add_subplot(111)

ax.text(0.075, 0, '\n'.join(cartman_top1g.feature), bbox={'facecolor': 'skyblue', 'edgecolor': 'black', 'alpha': 0.5, 'pad':5})
ax.text(0.075, 0.95, 'Cartman', fontweight='bold')
ax.text(0.275, 0, '\n'.join(stan_top1g.feature), bbox={'facecolor': 'skyblue', 'edgecolor': 'black', 'alpha': 0.5, 'pad':5})
ax.text(0.275, 0.95, 'Stan', fontweight='bold')
ax.text(0.475, 0, '\n'.join(kyle_top1g.feature), bbox={'facecolor': 'skyblue', 'edgecolor': 'black', 'alpha': 0.5, 'pad':5})
ax.text(0.475, 0.95, 'Kyle', fontweight='bold')
ax.text(0.675, 0, '\n'.join(butters_top1g.feature), bbox={'facecolor': 'skyblue', 'edgecolor': 'black', 'alpha': 0.5, 'pad':5})
ax.text(0.675, 0.95, 'Butters', fontweight='bold')
ax.text(0.875, 0, '\n'.join(randy_top1g.feature), bbox={'facecolor': 'skyblue', 'edgecolor': 'black', 'alpha': 0.5, 'pad':5})
ax.text(0.875, 0.95, 'Randy', fontweight='bold')

fig.suptitle('Top 20 Most Important Words', fontweight='bold')
plt.axis('off')
</code></pre>

<pre><code>(0.0, 1.0, 0.0, 1.0)
</code></pre>

<p><img src="output_62_1.png" alt="png" /></p>

<pre><code class="language-python">fig = plt.figure(figsize=(10, 5.7), facecolor = 'white')
ax = fig.add_subplot(111)

ax.text(0.0, 0, '\n'.join(cartman_top2g.feature), bbox={'facecolor': 'skyblue', 'edgecolor': 'black', 'alpha': 0.5, 'pad':5})
ax.text(0.0, 0.95, 'Cartman', fontweight='bold')
ax.text(0.19, 0, '\n'.join(stan_top2g.feature), bbox={'facecolor': 'skyblue', 'edgecolor': 'black', 'alpha': 0.5, 'pad':5})
ax.text(0.19, 0.95, 'Stan', fontweight='bold')
ax.text(0.375, 0, '\n'.join(kyle_top2g.feature), bbox={'facecolor': 'skyblue', 'edgecolor': 'black', 'alpha': 0.5, 'pad':5})
ax.text(0.375, 0.95, 'Kyle', fontweight='bold')
ax.text(0.625, 0, '\n'.join(butters_top2g.feature), bbox={'facecolor': 'skyblue', 'edgecolor': 'black', 'alpha': 0.5, 'pad':5})
ax.text(0.625, 0.95, 'Butters', fontweight='bold')
ax.text(0.82, 0, '\n'.join(randy_top2g.feature), bbox={'facecolor': 'skyblue', 'edgecolor': 'black', 'alpha': 0.5, 'pad':5})
ax.text(0.82, 0.95, 'Randy', fontweight='bold')

fig.suptitle('Top 20 Most Important Phrases', fontweight='bold')
plt.axis('off')
</code></pre>

<pre><code>(0.0, 1.0, 0.0, 1.0)
</code></pre>

<p><img src="output_63_1.png" alt="png" /></p>

<pre><code class="language-python"># find some special bigrams (they are more likely to form bigram than as individual words) 
from sklearn.feature_extraction.text import CountVectorizer

def get_count(n):
    '''return a dictionary with n-gram and their counts'''
    vect = CountVectorizer(stop_words='english', ngram_range=(n, n))
    counts = vect.fit_transform(doc)
    gram = vect.get_feature_names()
    counts_list = counts.sum(axis = 0)
    counts_list = np.asarray(counts_list).reshape(-1)
    gram_count = dict(zip(gram, counts_list))
    
    return gram_count

count_1g = get_count(1)
count_2g = get_count(2)

import operator

def find_special(count1, count2):
    '''return the top 20 special bigrams'''
    ratio = {}
    for bigram in count2:
        words = bigram.split()
        k1 = words[0]
        k2 = words[1]
        if k1 in count1 and k2 in count1:
            ratio[bigram] = float(count2[bigram])/((count1[k1] + 50)*(count1[k2] + 50)) # bayesian smoothing
    sorted_ratio = sorted(ratio.items(), key=operator.itemgetter(1), reverse=True)
    return sorted_ratio[:20]

find_special(count_1g, count_2g)
</code></pre>

<pre><code>[('mel gibson', 0.0047743055555555559),
 ('casa bonita', 0.0047332185886402754),
 ('trapper keeper', 0.0046474035158617904),
 ('prime minister', 0.0045582047685834501),
 ('kathie lee', 0.0044973544973544973),
 ('global warming', 0.0044532409698169219),
 ('los angeles', 0.0043186895011169029),
 ('rabble rabble', 0.0043044077134986227),
 ('cheesy poofs', 0.0043010752688172043),
 ('barbra streisand', 0.004097818902842036),
 ('meow meow', 0.003955895968352832),
 ('founding fathers', 0.0038377192982456138),
 ('phil collins', 0.0037071362372567192),
 ('san francisco', 0.0036910457963089541),
 ('pinewood derby', 0.0035502958579881655),
 ('mintberry crunch', 0.0035035035035035035),
 ('biggie smalls', 0.003472892147404978),
 ('okama gamesphere', 0.003383084577114428),
 ('customer service', 0.0033663366336633663),
 ('christopher reeve', 0.003335804299481097)]
</code></pre>

<h4 id="what-did-kenny-say">What did Kenny say</h4>

<pre><code class="language-python">kenny_text = ''.join(character_lines[character_lines['Character'] == 'Kenny']['Line_nopunc'])
</code></pre>

<pre><code class="language-python">mask = imread('kenny.jpg') # mask
image_colors = ImageColorGenerator(mask) # custom color using mask image

wc = WordCloud(background_color = 'white', mask = mask, max_words = 3000, \
               stopwords = STOPWORDS, color_func = image_colors, scale = 1.0, random_state= 10)
wc.generate(kenny_text)
wc.to_file('kenny_wordcloud.png')

plt.figure(figsize = (6, 6), facecolor = 'white')
plt.imshow(wc)
plt.axis('off')
</code></pre>

<pre><code>(-0.5, 354.5, 478.5, -0.5)
</code></pre>

<p><img src="output_67_1.png" alt="png" /></p>

<pre><code class="language-python">kenny_word = [w for w in kenny_text.split()]
kenny_nostopword = [w for w in kenny_word if w not in list(STOPWORDS)]

vec1_k = vec_1g.transform([' '.join(kenny_nostopword)])
vec2_k = vec_2g.transform([' '.join(kenny_nostopword)])
kenny_top1g = top_feats_in_doc(vec1_k, features_1g, row_id=0, top_n=20)
kenny_top2g = top_feats_in_doc(vec2_k, features_2g, row_id=0, top_n=20)
</code></pre>

<pre><code class="language-python">kenny_top1g
</code></pre>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature</th>
      <th>tfidf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>yeah</td>
      <td>0.434546</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fuck</td>
      <td>0.282016</td>
    </tr>
    <tr>
      <th>2</th>
      <td>woohoo</td>
      <td>0.278473</td>
    </tr>
    <tr>
      <th>3</th>
      <td>dude</td>
      <td>0.246265</td>
    </tr>
    <tr>
      <th>4</th>
      <td>guys</td>
      <td>0.233252</td>
    </tr>
    <tr>
      <th>5</th>
      <td>hey</td>
      <td>0.233143</td>
    </tr>
    <tr>
      <th>6</th>
      <td>oh</td>
      <td>0.215685</td>
    </tr>
    <tr>
      <th>7</th>
      <td>fucking</td>
      <td>0.162086</td>
    </tr>
    <tr>
      <th>8</th>
      <td>okay</td>
      <td>0.135240</td>
    </tr>
    <tr>
      <th>9</th>
      <td>huh</td>
      <td>0.125770</td>
    </tr>
    <tr>
      <th>10</th>
      <td>uh</td>
      <td>0.120562</td>
    </tr>
    <tr>
      <th>11</th>
      <td>fuckin</td>
      <td>0.110786</td>
    </tr>
    <tr>
      <th>12</th>
      <td>cartman</td>
      <td>0.099954</td>
    </tr>
    <tr>
      <th>13</th>
      <td>kyle</td>
      <td>0.086085</td>
    </tr>
    <tr>
      <th>14</th>
      <td>awesome</td>
      <td>0.085089</td>
    </tr>
    <tr>
      <th>15</th>
      <td>know</td>
      <td>0.082031</td>
    </tr>
    <tr>
      <th>16</th>
      <td>gotta</td>
      <td>0.079955</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ow</td>
      <td>0.075277</td>
    </tr>
    <tr>
      <th>18</th>
      <td>io</td>
      <td>0.074782</td>
    </tr>
    <tr>
      <th>19</th>
      <td>ha</td>
      <td>0.074569</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">kenny_top2g
</code></pre>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>feature</th>
      <th>tfidf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>hey guys</td>
      <td>0.141637</td>
    </tr>
    <tr>
      <th>1</th>
      <td>yeah yeah</td>
      <td>0.113497</td>
    </tr>
    <tr>
      <th>2</th>
      <td>uh huh</td>
      <td>0.095976</td>
    </tr>
    <tr>
      <th>3</th>
      <td>dude fuck</td>
      <td>0.085868</td>
    </tr>
    <tr>
      <th>4</th>
      <td>yeah totally</td>
      <td>0.074966</td>
    </tr>
    <tr>
      <th>5</th>
      <td>fuck yeah</td>
      <td>0.073601</td>
    </tr>
    <tr>
      <th>6</th>
      <td>woohoo yeah</td>
      <td>0.071321</td>
    </tr>
    <tr>
      <th>7</th>
      <td>con te</td>
      <td>0.069687</td>
    </tr>
    <tr>
      <th>8</th>
      <td>oh god</td>
      <td>0.066066</td>
    </tr>
    <tr>
      <th>9</th>
      <td>purincessu kenni</td>
      <td>0.063784</td>
    </tr>
    <tr>
      <th>10</th>
      <td>ha ha</td>
      <td>0.062374</td>
    </tr>
    <tr>
      <th>11</th>
      <td>fuck dude</td>
      <td>0.055750</td>
    </tr>
    <tr>
      <th>12</th>
      <td>ha ha ha</td>
      <td>0.053968</td>
    </tr>
    <tr>
      <th>13</th>
      <td>uh oh</td>
      <td>0.053899</td>
    </tr>
    <tr>
      <th>14</th>
      <td>yeah fuck</td>
      <td>0.051027</td>
    </tr>
    <tr>
      <th>15</th>
      <td>know yeah</td>
      <td>0.049977</td>
    </tr>
    <tr>
      <th>16</th>
      <td>hey hey</td>
      <td>0.047844</td>
    </tr>
    <tr>
      <th>17</th>
      <td>nuh uh</td>
      <td>0.047547</td>
    </tr>
    <tr>
      <th>18</th>
      <td>yeah woohoo</td>
      <td>0.044345</td>
    </tr>
    <tr>
      <th>19</th>
      <td>huh uh</td>
      <td>0.044345</td>
    </tr>
  </tbody>
</table>
</div>

        </div>
      </div>
    </div>

    <a href="#" class="back-to-top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>

    
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'yanfeiwu';
    var disqus_identifier = '\/blog\/southpark_file\/southpark_lines_exploration\/';
    var disqus_title = '';
    var disqus_url = '\/blog\/southpark_file\/southpark_lines_exploration\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
   

          </div>
      </div>
  </div>
  <script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.cookie.js"> </script>
<script src="/js/ekko-lightbox.js"></script>
<script src="/js/jquery.scrollTo.min.js"></script>
<script src="/js/masonry.pkgd.min.js"></script>
<script src="/js/imagesloaded.pkgd.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/front.js"></script>
<script src="/js/backtotop.js"></script> 

</body>
</html>
